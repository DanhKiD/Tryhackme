> # Threat Intelligence for SOC

# Summary
<!-- TOC -->

- [Summary](#summary)
    - [Task 2 - Threat Intelligence Feeds](#task-2---threat-intelligence-feeds)
    - [Task 3 - Intelligence-driven Prevention](#task-3---intelligence-driven-prevention)
    - [Task 4 - Intelligence-driven Detection](#task-4---intelligence-driven-detection)

<!-- /TOC -->

## Task 2 - Threat Intelligence Feeds
1. How many unique IP addresses were provided in the IOC list?<br>
    Paste the list IPs to [https://uncoder.io/](https://uncoder.io/)<br>
    It will display number of unique IPs in list.<br>
    ![](images/1.png)<br>
    **Answer:** 11

1. Based on the set of IOCs, how many IOC hits were discovered in the logs?<br>
    Paste the query into filter. You will see the number of hit IOC.<br>
    ![](images/5.png)<br>
    **Answer:** 48

1. Out of the total number of IOCs, how many unique IP addresses were discovered in the logs?<br>
    Change the value of "Number of value" to 10, you will see all the unique IPs.<br>
    ![](images/6.png)<br>
    **Answer:** 7

1. How many connections were made to 185[.]224[.]128[.]215?<br>
    View in `Visualize`.<br>
    ![](images/2.png)<br>
    **Answer:** 21

1. What is the IP address of the compromised host? <br>
    In source.ip, only one IP address appear.<br>
    ![](images/3.png)<br>
    **Answer:** 10.10.196.49

1. What is the destination port of connections made to 107[.]175[.]202[.]151?<br>
    Filter with this IP, and view in destination.port.<br>
    ![](images/4.png)<br>
    **Answer:** 80

## Task 3 - Intelligence-driven Prevention
1. How many DNS queries to agrosaoxe[.]info have been created?<br>
    Filter with `dns.question.name: "agrosaoxe.info"`.<br>
    ![](images/7.png)<br>
    **Answer:** 11

1. Before deploying the sinkhole configuration, what IPv4 addresses are resolved by agrosaoxe[.]info? (format: IPs in ascending order)<br>
    In dns.resolve_ip you will two public IPs.<br>
    ![](images/8.png)<br>
    **Answer:** 172.67.186.179,104.21.48.143

1. What is the IP address used for DNS Sinkhole?<br>
    In the image above, almost request receives dns respone with IP 192.168.5.13.<br>
    **Answer:** 192.168.5.13

1. How many hits were caused by connections to sinkholed domains?
    Filter with dns sinkholded IP.<br>
    **Answer:** 192.168.5.13

1. How many unique domains have been sinkholed?<br>
    Visualize dns.question_name, you will see 12 domain have dns.response_ip is 192.168.5.13<br>
    **Answer:** 12

## Task 4 - Intelligence-driven Detection
1. What is the value of the alert field in the converted ElastAlert rule?<br>
    Read file sinhold.yaml<br>
    ![](images/12.png)<br>
    **Answer:** debug

1. How many alerts were generated by the rule?<br>
    Modify sinkhole.yaml as the description, then run the given command.<br>
    You will see it sents 40 alerts.<br>
    ![](images/13.png)<br>
    **Answer:** 40

1. How many unique domains were sinkholed via 0.0.0.0?<br>
    Filter `"query"` field, then use `sort, uniq, wc -l` to count number of unique domains.<br>
    ![](images/14.png)<br>
    **Answer:** 7

1. What is the sinkholed domain that has .ru TLD?<br>
    From the image above<br>
    **Answwer:** twizt.ru

